<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A Journey of Us</title>
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <link rel="stylesheet" href="{% static 'css/timeline.css' %}">

  <script>
    const chapterMusic = {
      chapter1: "{{ chapter_music.chapter1|default:'' }}",
      chapter2: "{{ chapter_music.chapter2|default:'' }}",
      chapter3: "{{ chapter_music.chapter3|default:'' }}",
      'post-chapter3': "{{ chapter_music.post_chapter3|default:'' }}"
    };
  </script>
</head>

<body>
  <main id="timeline-container">

    <audio id="chapter-audio" autoplay loop></audio>

    <div id="welcome-page" class="page chapter chapter1 active">
      <h1>Welcome to our Journey</h1>
      <p>A collection of our best memories, just for you.</p>
      <button id="start-journey-button">Start the Journey</button>
    </div>

    {% for memory in memories %}
    <div class="page chapter chapter1 hidden" data-page-id="{{ forloop.counter }}">
      <h2>{{ memory.title }}</h2>
      <p>{{ memory.description }}</p>
      <div class="collage">
        {% for image in memory.images.all %}
        <div class="collage-item">
          <img src="{{ image.image.url }}" alt="{{ memory.title }}">
          {% if image.comment %}
          <div class="image-comment">{{ image.comment }}</div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      <div class="navigation-buttons">
        <button class="prev-page">Prev</button>
        <button class="next-page">Next</button>
      </div>
    </div>
    {% endfor %}

    <div id="end-of-chapter1" class="page chapter chapter1 hidden">
      <h2>And that's just the beginning...</h2>
      <p>...click below to continue our journey.</p>
      <button class="next-chapter" data-target="chapter2-page">Go to Chapter 2</button>
    </div>

    <div id="chapter2-page" class="page chapter chapter2 hidden">
      <h2>My Appreciation to You</h2>
      <p>This section is all about the little things I love about you.</p>
      <div class="collage">
        {% for image in appreciation_images %}
        <div class="collage-item">
          <img src="{{ image.image.url }}" alt="Appreciation Image">
          {% if image.comment %}
          <div class="image-comment">{{ image.comment }}</div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      <div class="navigation-buttons">
        <button class="prev-chapter" data-target="end-of-chapter1">Prev Chapter</button>
        <button class="next-chapter" data-target="chapter3-page">Next Chapter</button>
      </div>
    </div>

    <div id="chapter3-page" class="page chapter chapter3 hidden">
      <h2>A Letter for You</h2>
      <div class="letter-content">
        <p>My dearest...</p>
        <p>This is where your personal letter will go. You can write your heartfelt message here, surrounded by the
          beautiful design.</p>
      </div>
      <div class="navigation-buttons">
        <button class="prev-chapter" data-target="chapter2-page">Prev Chapter</button>
        <button class="next-chapter" data-target="post-chapter3-page">Next Chapter</button>
      </div>
    </div>

    <div id="post-chapter3-page" class="page chapter chapter-post-3 hidden">
      <h2>What's next? Hmmmm...</h2>
      <p>Let's stay strong! Our journey is still going.</p>
      <div class="navigation-buttons">
        <button class="prev-chapter" data-target="chapter3-page">Back to the Letter</button>
        <button class="return-home">Back to Start</button>
      </div>
    </div>

  </main>
  <script src="{% static 'js/script.js' %}"></script>
</body>

</html>
