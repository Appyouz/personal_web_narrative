<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A Journey of Us</title>
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <link rel="stylesheet" href="{% static 'css/timeline.css' %}">

  <script>
    const chapterMusic = {
      chapter1: "{{ chapter_music.chapter1|default:'' }}",
      chapter2: "{{ chapter_music.chapter2|default:'' }}",
      chapter3: "{{ chapter_music.chapter3|default:'' }}",
      'post-chapter3': "{{ chapter_music.post_chapter3|default:'' }}"
    };
  </script>
</head>

<body>
  <main id="timeline-container">
    <audio id="chapter-audio" autoplay loop></audio>

    <!-- Welcome Page -->
    <div id="welcome-page" class="page chapter chapter1 active">
      <img src="{% static 'images/bread.png' %}" alt="Welcome Image" class="welcome-image">
      <h1>{{ secret_texts.welcome_title }}</h1>
      <p>{{ secret_texts.welcome_subtitle }}</p>
      <button id="start-journey-button">Start the Journey</button>
    </div>

    {% for memory in memories %}
    <div class="page chapter chapter1" data-page-id="{{ forloop.counter }}" {% if forloop.last %}id="last-memory-page"
      {% endif %}>
      <h2>{{ memory.title }}</h2>
      <p>{{ memory.description }}</p>
      <div class="collage">
        {% for image in memory.images.all %}
        <div class="collage-item">
          <img src="{{ image.image.url }}" alt="{{ memory.title }}">
          {% if image.comment %}
          <div class="image-comment">{{ image.comment }}</div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      <div class="navigation-buttons">
        <button class="prev-page">Prev</button>
        <button class="next-page">Next</button>
      </div>
    </div>
    {% endfor %}

    <!-- End of Chapter 1 -->
    <div id="end-of-chapter1" class="page chapter chapter1">
      <h2>And that's just the beginning...</h2>
      <p>...click below to continue our journey.</p>
      <button class="next-chapter" data-target="chapter2-page">Go to Chapter 2</button>
    </div>

    <!-- Chapter 2 -->
    <div id="chapter2-page" class="page chapter chapter2">
      <h2>My Appreciation to You</h2>
      <p>{{ secret_texts.chapter2_intro }}</p>
      <div class="collage">
        {% for image in appreciation_images %}
        <div class="collage-item">
          <img src="{{ image.image.url }}" alt="Appreciation Image">
          {% if image.comment %}
          <div class="image-comment">{{ image.comment }}</div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      <div class="navigation-buttons">
        <button class="prev-chapter" data-target="end-of-chapter1">Prev Chapter</button>
        <button class="next-chapter" data-target="end-of-chapter2">Next Chapter</button>
      </div>
    </div>

    <!-- End of Chapter 2 -->
    <div id="end-of-chapter2" class="page chapter chapter2">
      <h2>My Heart is Full</h2>
      <p>{{ secret_texts.end_chapter2 }}</p>
      <button class="next-chapter" data-target="chapter3-page">Continue to My Letter</button>
    </div>

    <!-- Chapter 3 -->
    <div id="chapter3-page" class="page chapter chapter3">
      <h2>{{ secret_texts.chapter3_title }}</h2>
      <div class="letter-content">
        <p>{{ secret_texts.chapter3_letter }}</p>
      </div>
      <div class="navigation-buttons">
        <button class="prev-chapter" data-target="end-of-chapter2">Prev Chapter</button>
        <button class="next-chapter" data-target="whats-next-page">Next Chapter</button>
      </div>
    </div>

    <!-- Whats Next Page -->
    <div id="whats-next-page" class="page chapter chapter-post-3">
      <h2>What's next? Hmmmm...</h2>
      <p>Choose your path:</p>
      <div class="whats-next-buttons">
        <button class="whats-next-btn" data-choice="continue">Keep Going ðŸš€</button>
        <button class="whats-next-btn" data-choice="break">Take a Break ðŸ˜¢</button>
      </div>
    </div>

    <!-- Give Up Page -->
    <div id="give-up-page" class="page chapter chapter-post-3">
      <h2>{{ secret_texts.give_up_title }}</h2>
      <p>{{ secret_texts.give_up_subtitle }}</p>
      <button class="next-chapter" data-target="choice-page">Fine, you do you</button>
    </div>

    <!-- Choice Page -->
    <div id="choice-page" class="page chapter chapter-post-3">
      <h2>{{ secret_texts.choice_title }}</h2>
      <p>{{ secret_texts.choice_subtitle }}</p>
      <button class="next-chapter" data-target="final-page">Continue Anyway</button>
    </div>

    <!-- Final Page -->
    <div id="final-page" class="page chapter chapter-post-3">
      <h2>{{ secret_texts.final_title }}</h2>
      <p>{{ secret_texts.final_subtitle }}</p>
      <div class="navigation-buttons">
        <button class="prev-chapter" data-target="chapter3-page">Back to Letter</button>
        <button class="return-home">Start Over</button>
      </div>
    </div>

  </main>

  <script src="{% static 'js/script.js' %}"></script>
</body>

</html>
